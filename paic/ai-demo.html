<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Demo | Purpose Engine</title>
  
  <!-- Favicon and Social Sharing -->
  <link rel="icon" type="image/png" href="https://kesmit3.github.io/paic/favicon32.png?v=2">
  <link rel="apple-touch-icon" href="https://kesmit3.github.io/paic/purposeengineappletouchicon.png">
  <meta property="og:title" content="AI Demo | Purpose Engine">
  <meta property="og:description" content="AI-powered classroom demo that connects today's lesson to student career dreams in real-time.">
  <meta property="og:image" content="https://kesmit3.github.io/paic/purposeengineogsquare.png">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --navy: #0D1421;
      --navy-light: #1a2332;
      --primary: #0067b1;
      --primary-dark: #004b85;
      --purple: #8B5CF6;
      --pink: #EC4899;
      --yellow: #F59E0B;
      --green: #10B981;
      --cyan: #06B6D4;
      --gray-400: #94A3B8;
      --gray-500: #64748B;
      --gray-600: #475569;
      --gray-700: #334155;
      --gray-800: #1E293B;
    }
    
    body {
      font-family: 'Plus Jakarta Sans', -apple-system, sans-serif;
      background: linear-gradient(135deg, var(--navy) 0%, var(--navy-light) 100%);
      color: white;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header */
    .header {
      background: rgba(30, 41, 59, 0.8);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--gray-700);
      padding: 16px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: white;
    }
    
    .logo img {
      height: 32px;
    }
    
    .logo-divider {
      width: 1px;
      height: 24px;
      background: var(--gray-600);
    }
    
    .logo-text {
      font-size: 16px;
      font-weight: 700;
    }
    
    .header-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .back-link {
      color: var(--gray-400);
      text-decoration: none;
      font-size: 13px;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: color 0.2s;
    }
    
    .back-link:hover {
      color: white;
    }
    
    /* Main Container */
    .main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 48px 32px;
    }
    
    /* Hero Section */
    .hero {
      text-align: center;
      margin-bottom: 48px;
    }
    
    .hero-icon {
      font-size: 64px;
      margin-bottom: 16px;
    }
    
    .hero h1 {
      font-size: 48px;
      font-weight: 800;
      letter-spacing: -1px;
      margin-bottom: 12px;
      background: linear-gradient(135deg, white 0%, var(--gray-400) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .hero p {
      font-size: 20px;
      color: var(--gray-400);
      max-width: 600px;
      margin: 0 auto;
    }
    
    /* Input Section */
    .input-section {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid var(--gray-700);
      border-radius: 24px;
      padding: 32px;
      margin-bottom: 32px;
    }
    
    .input-row {
      display: flex;
      gap: 16px;
      align-items: flex-end;
    }
    
    .input-group {
      flex: 1;
    }
    
    .input-group label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-400);
      margin-bottom: 8px;
    }
    
    .input-group input,
    .input-group select {
      width: 100%;
      padding: 16px 20px;
      background: var(--gray-800);
      border: 2px solid var(--gray-700);
      border-radius: 12px;
      color: white;
      font-size: 18px;
      font-family: inherit;
      transition: all 0.2s;
    }
    
    .input-group input:focus,
    .input-group select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(0, 103, 177, 0.2);
    }
    
    .input-group input::placeholder {
      color: var(--gray-500);
    }
    
    .input-group select {
      cursor: pointer;
    }
    
    .input-group select option {
      background: var(--gray-800);
    }
    
    .compute-btn {
      padding: 16px 32px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }
    
    .compute-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 103, 177, 0.4);
    }
    
    .compute-btn:active {
      transform: translateY(0);
    }
    
    /* Quick Career Buttons */
    .quick-careers {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--gray-700);
    }
    
    .quick-careers-label {
      font-size: 12px;
      color: var(--gray-500);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .career-pills {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .career-pill {
      padding: 10px 18px;
      background: rgba(51, 65, 85, 0.5);
      border: 1px solid var(--gray-700);
      border-radius: 24px;
      color: var(--gray-400);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .career-pill:hover {
      background: rgba(51, 65, 85, 0.8);
      border-color: var(--gray-600);
      color: white;
    }
    
    .career-pill.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
    }
    
    /* Results Section */
    .results {
      display: none;
    }
    
    .results.visible {
      display: block;
      animation: fadeIn 0.4s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* GNN Visualization */
    .gnn-viz {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid var(--gray-700);
      border-radius: 24px;
      padding: 32px;
      margin-bottom: 24px;
      position: relative;
      overflow: hidden;
    }
    
    .gnn-viz::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 30% 50%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 70% 50%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }
    
    .gnn-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      position: relative;
    }
    
    .gnn-title {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .gnn-title .icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--purple) 0%, var(--cyan) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }
    
    .gnn-title h2 {
      font-size: 20px;
      font-weight: 700;
    }
    
    .gnn-title .subtitle {
      font-size: 13px;
      color: var(--gray-500);
    }
    
    .alignment-score {
      text-align: center;
      padding: 16px 24px;
      background: rgba(16, 185, 129, 0.15);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 16px;
    }
    
    .alignment-score .number {
      font-size: 36px;
      font-weight: 800;
      color: var(--green);
      line-height: 1;
    }
    
    .alignment-score .label {
      font-size: 11px;
      color: var(--gray-400);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    /* Graph Visual */
    .graph-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 24px;
      margin: 32px 0;
      position: relative;
    }
    
    .graph-node {
      padding: 16px 24px;
      border-radius: 16px;
      text-align: center;
      position: relative;
      z-index: 1;
    }
    
    .graph-node.career {
      background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
      min-width: 200px;
    }
    
    .graph-node.lesson {
      background: linear-gradient(135deg, var(--primary) 0%, var(--cyan) 100%);
      min-width: 200px;
    }
    
    .graph-node .node-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }
    
    .graph-node .node-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1px;
      opacity: 0.8;
      margin-bottom: 4px;
    }
    
    .graph-node .node-value {
      font-size: 16px;
      font-weight: 700;
    }
    
    .graph-edge {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .edge-line {
      width: 120px;
      height: 4px;
      background: linear-gradient(90deg, var(--purple), var(--cyan));
      border-radius: 2px;
      position: relative;
    }
    
    .edge-line::after {
      content: '';
      position: absolute;
      right: -8px;
      top: -4px;
      border: 6px solid transparent;
      border-left-color: var(--cyan);
    }
    
    .edge-skills {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 160px;
    }
    
    .skill-tag {
      background: rgba(16, 185, 129, 0.2);
      border: 1px solid rgba(16, 185, 129, 0.4);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      color: var(--green);
    }
    
    /* Reframed Output */
    .reframed-section {
      background: var(--gray-800);
      border-radius: 16px;
      padding: 24px;
      margin-top: 24px;
      position: relative;
    }
    
    .reframed-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--yellow);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .reframed-text {
      font-size: 24px;
      font-weight: 600;
      line-height: 1.5;
      color: white;
    }
    
    .reframed-text strong {
      color: var(--cyan);
    }
    
    /* Discussion Starters */
    .discussion-section {
      background: rgba(30, 41, 59, 0.6);
      border: 1px solid var(--gray-700);
      border-radius: 24px;
      padding: 32px;
    }
    
    .discussion-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .discussion-header .icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: rgba(245, 158, 11, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    
    .discussion-header h3 {
      font-size: 18px;
      font-weight: 700;
    }
    
    .discussion-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .discussion-item {
      display: flex;
      align-items: flex-start;
      gap: 16px;
      padding: 16px 20px;
      background: var(--gray-800);
      border-radius: 12px;
      font-size: 16px;
      line-height: 1.5;
      transition: all 0.2s;
      cursor: pointer;
    }
    
    .discussion-item:hover {
      background: var(--gray-700);
      transform: translateX(4px);
    }
    
    .discussion-item .number {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: var(--yellow);
      color: var(--navy);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
      flex-shrink: 0;
    }
    
    /* Footer */
    .footer {
      margin-top: 48px;
      padding: 24px;
      text-align: center;
      border-top: 1px solid var(--gray-700);
    }
    
    .footer-sources {
      display: flex;
      justify-content: center;
      gap: 24px;
      margin-bottom: 16px;
    }
    
    .footer-source {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: var(--gray-500);
    }
    
    .footer-source .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--green);
    }
    
    .footer-credit {
      font-size: 13px;
      color: var(--gray-500);
    }
    
    .footer-credit a {
      color: var(--primary);
      text-decoration: none;
    }
    
    .footer-credit a:hover {
      text-decoration: underline;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .main {
        padding: 24px 16px;
      }
      
      .hero h1 {
        font-size: 32px;
      }
      
      .hero p {
        font-size: 16px;
      }
      
      .input-row {
        flex-direction: column;
      }
      
      .graph-container {
        flex-direction: column;
      }
      
      .edge-line {
        width: 4px;
        height: 60px;
      }
      
      .edge-line::after {
        right: -4px;
        top: auto;
        bottom: -8px;
        border: 6px solid transparent;
        border-top-color: var(--cyan);
        border-left-color: transparent;
      }
      
      .reframed-text {
        font-size: 18px;
      }
      
      .career-pills {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="index.html" class="logo">
        <img src="https://kesmit3.github.io/paic/upliftlogo.png" alt="Uplift Education">
        <div class="logo-divider"></div>
        <span class="logo-text">Purpose Engine</span>
      </a>
      <div class="header-badge">
        <span>&#129302;</span>
        <span>Live AI Demo</span>
      </div>
    </div>
    <div class="header-right">
      <a href="educator-dashboard.html" class="back-link">
        <span>&larr;</span>
        <span>Back to Dashboard</span>
      </a>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <!-- Hero -->
    <section class="hero">
      <div class="hero-icon">&#127919;</div>
      <h1>Why Does This Matter?</h1>
      <p>Enter a student&rsquo;s dream career and watch AI connect today&rsquo;s lesson to their future goals&mdash;in real time.</p>
    </section>

    <!-- Input Section -->
    <section class="input-section">
      <div class="input-row">
        <div class="input-group">
          <label for="careerInput">&#127775; Student&rsquo;s Dream Career <span style="font-weight: 400; color: var(--cyan); font-size: 11px;">via Schoolinks</span></label>
          <input type="text" id="careerInput" placeholder="e.g., Electrician, Cybersecurity Analyst, Architect...">
        </div>
        <div class="input-group" style="max-width: 280px;">
          <label for="lessonSelect">&#128218; Today&rsquo;s Lesson <span style="font-weight: 400; color: var(--purple); font-size: 11px;">via Schoology</span></label>
          <select id="lessonSelect">
            <option value="chemistry-ratios">Chemistry: Stoichiometry &amp; Ratios</option>
            <option value="chemistry-periodic">Chemistry: Periodic Table Trends</option>
            <option value="biology-cells">Biology: Cell Structure &amp; Function</option>
            <option value="biology-genetics">Biology: Genetics &amp; Heredity</option>
            <option value="physics-circuits">Physics: Electrical Circuits</option>
            <option value="physics-motion">Physics: Forces &amp; Motion</option>
            <option value="algebra-linear">Algebra: Linear Equations</option>
            <option value="algebra-quadratic">Algebra: Quadratic Functions</option>
            <option value="geometry-proofs">Geometry: Proofs &amp; Logic</option>
            <option value="statistics-data">Statistics: Data Analysis</option>
            <option value="english-persuasive">English: Persuasive Writing</option>
            <option value="english-research">English: Research &amp; Citations</option>
            <option value="history-primary">History: Primary Source Analysis</option>
            <option value="history-economics">History: Economic Systems</option>
            <option value="cs-algorithms">CS: Algorithms &amp; Logic</option>
          </select>
        </div>
        <button class="compute-btn" onclick="runGNN()">
          <span>&#9889;</span>
          <span>Connect the Dots</span>
        </button>
      </div>

      <!-- Quick Career Pills -->
      <div class="quick-careers">
        <div class="quick-careers-label">&#128161; Student profiles from Schoolinks:</div>
        <div class="career-pills">
          <button class="career-pill" onclick="setCareer('Master Electrician')">&#128295; Ivan &mdash; Electrician</button>
          <button class="career-pill" onclick="setCareer('Cybersecurity Analyst')">&#128737; Marcus &mdash; Cybersecurity</button>
          <button class="career-pill" onclick="setCareer('Sustainable Design Director')">&#127793; Maya &mdash; Sustainable Design</button>
          <button class="career-pill" onclick="setCareer('Music Producer')">&#127908; DeShawn &mdash; Music Producer</button>
          <button class="career-pill" onclick="setCareer('Healthcare Professional')">&#129658; Sarah &mdash; Healthcare</button>
        </div>
      </div>
      
      <!-- Data Synthesis Note -->
      <div style="margin-top: 20px; padding: 12px 16px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.2); border-radius: 10px; display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 20px;">&#128279;</span>
        <span style="font-size: 13px; color: var(--gray-400);"><strong style="color: var(--green);">Shared Visibility Layer:</strong> Purpose Engine synthesizes student career goals from Schoolinks with today&rsquo;s lesson objectives from Schoology&mdash;no manual data entry required.</span>
      </div>
    </section>

    <!-- Results Section -->
    <section class="results" id="results">
      <!-- GNN Visualization -->
      <div class="gnn-viz">
        <div class="gnn-header">
          <div class="gnn-title">
            <div class="icon">&#128300;</div>
            <div>
              <h2>Graph Neural Network Mapping</h2>
              <div class="subtitle">AI-powered relevance propagation</div>
            </div>
          </div>
          <div class="alignment-score">
            <div class="number" id="alignmentScore">0%</div>
            <div class="label">Alignment</div>
          </div>
        </div>

        <!-- Graph Visual -->
        <div class="graph-container">
          <div class="graph-node career">
            <div class="node-icon">&#127919;</div>
            <div class="node-label">Career Goal</div>
            <div class="node-value" id="careerNode">Sustainable Design Director</div>
          </div>
          
          <div class="graph-edge">
            <div class="edge-skills" id="matchedSkills">
              <span class="skill-tag">ratios</span>
              <span class="skill-tag">material science</span>
            </div>
            <div class="edge-line"></div>
          </div>
          
          <div class="graph-node lesson">
            <div class="node-icon">&#128218;</div>
            <div class="node-label">Today&rsquo;s Lesson</div>
            <div class="node-value" id="lessonNode">Chemistry Ratios</div>
          </div>
        </div>

        <!-- Reframed Output -->
        <div class="reframed-section">
          <div class="reframed-label">
            <span>&#10024;</span>
            <span>AI-Generated Connection</span>
          </div>
          <div class="reframed-text" id="reframedText">
            For someone aiming to be a <strong>Sustainable Design Director</strong>, today&rsquo;s &ldquo;Chemistry Ratios&rdquo; builds <strong>material ratios</strong> skills needed to create energy-efficient buildings and fight climate change.
          </div>
        </div>
      </div>

      <!-- Discussion Starters -->
      <div class="discussion-section">
        <div class="discussion-header">
          <div class="icon">&#128172;</div>
          <h3>Discussion Starters for Your Class</h3>
        </div>
        <div class="discussion-list" id="discussionList">
          <div class="discussion-item">
            <span class="number">1</span>
            <span>How might calculating ratios help you in your future career?</span>
          </div>
          <div class="discussion-item">
            <span class="number">2</span>
            <span>What part of this lesson feels most useful for your future?</span>
          </div>
          <div class="discussion-item">
            <span class="number">3</span>
            <span>If we reframed tomorrow&rsquo;s lesson the same way, what would you want to see?</span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-sources">
      <span class="footer-source"><span class="dot" style="background: #1976D2;"></span> PowerSchool (attendance)</span>
      <span class="footer-source"><span class="dot" style="background: #7B1FA2;"></span> Schoology (lessons)</span>
      <span class="footer-source"><span class="dot" style="background: #00897B;"></span> Schoolinks (careers)</span>
    </div>
    <div class="footer-credit">
      Purpose Engine &mdash; <a href="https://www.uplifteducation.org" target="_blank">Uplift Education</a> | Presidential AI Challenge 2026
    </div>
  </footer>

  <script>
    // ============================================
    // ENHANCED GNN SIMULATION
    // Graph Neural Network for Purpose Engine
    // ============================================
    
    const gnnGraph = {
      careers: {
        "Master Electrician": {
          keySkills: ["circuits", "ratios", "safety codes", "troubleshooting", "voltage calculations", "ohm's law"],
          whyMatters: "wiring buildings safely, running your own electrical business, and keeping the lights on for everyone",
          icon: "&#128295;"
        },
        "Cybersecurity Analyst": {
          keySkills: ["logic", "pattern recognition", "risk assessment", "data analysis", "problem-solving", "encryption"],
          whyMatters: "protecting critical systems, stopping hackers, and defending the digital infrastructure we all depend on",
          icon: "&#128737;"
        },
        "Sustainable Design Director": {
          keySkills: ["material ratios", "eco-innovation", "spatial reasoning", "design", "sustainability", "chemistry"],
          whyMatters: "creating energy-efficient buildings and fighting climate change through smarter architecture",
          icon: "&#127793;"
        },
        "Healthcare Professional": {
          keySkills: ["biology", "analysis", "data interpretation", "patient care", "chemistry", "ratios"],
          whyMatters: "diagnosing conditions, calculating medication dosages, and saving lives in hospitals",
          icon: "&#129658;"
        },
        "Engineer": {
          keySkills: ["physics", "ratios", "design", "innovation", "modeling", "circuits", "math"],
          whyMatters: "building real-world systems like rockets, bridges, electric vehicles, and the technology of tomorrow",
          icon: "&#128640;"
        },
        "Entrepreneur": {
          keySkills: ["economics", "risk assessment", "creative problem-solving", "modeling", "data analysis", "persuasion"],
          whyMatters: "calculating business viability, pitching investors, and turning your ideas into successful companies",
          icon: "&#128176;"
        },
        "Music Producer": {
          keySkills: ["ratios", "frequency analysis", "technology", "creativity", "audio engineering", "math"],
          whyMatters: "mixing tracks with perfect sound balance, mastering audio frequencies, and building your own studio",
          icon: "&#127908;"
        },
        "Video Game Designer": {
          keySkills: ["physics", "logic", "creativity", "math", "problem-solving", "design"],
          whyMatters: "creating immersive game worlds with realistic physics and engaging gameplay mechanics",
          icon: "&#127918;"
        },
        "Lawyer": {
          keySkills: ["logic", "persuasion", "analysis", "writing", "research", "problem-solving"],
          whyMatters: "building compelling arguments, analyzing evidence, and advocating for justice",
          icon: "&#9878;"
        },
        "Data Scientist": {
          keySkills: ["data analysis", "statistics", "modeling", "math", "problem-solving", "pattern recognition"],
          whyMatters: "uncovering insights from data that drive billion-dollar business decisions",
          icon: "&#128202;"
        }
      },
      
      lessons: {
        "chemistry-ratios": {
          name: "Chemistry: Stoichiometry & Ratios",
          objectives: ["Calculate mixtures and proportions", "Understand material composition", "Balance equations"],
          tags: ["ratios", "mixtures", "proportions", "material science", "chemistry", "math", "calculations"]
        },
        "chemistry-periodic": {
          name: "Chemistry: Periodic Table Trends",
          objectives: ["Identify element properties", "Predict chemical behavior", "Understand atomic structure"],
          tags: ["chemistry", "patterns", "analysis", "properties", "science", "research"]
        },
        "biology-cells": {
          name: "Biology: Cell Structure & Function",
          objectives: ["Identify cell components", "Understand cellular processes", "Compare cell types"],
          tags: ["biology", "analysis", "systems", "health", "science", "research", "patient care"]
        },
        "biology-genetics": {
          name: "Biology: Genetics & Heredity",
          objectives: ["Understand DNA structure", "Predict inheritance patterns", "Analyze genetic data"],
          tags: ["biology", "data analysis", "patterns", "health", "science", "problem-solving", "research"]
        },
        "physics-circuits": {
          name: "Physics: Electrical Circuits",
          objectives: ["Understand electrical flow", "Calculate resistance and voltage", "Design simple circuits"],
          tags: ["circuits", "physics", "voltage calculations", "ohm's law", "electricity", "troubleshooting", "design"]
        },
        "physics-motion": {
          name: "Physics: Forces & Motion",
          objectives: ["Calculate velocity and acceleration", "Apply Newton's laws", "Analyze real-world motion"],
          tags: ["physics", "math", "calculations", "modeling", "design", "problem-solving", "engineering"]
        },
        "algebra-linear": {
          name: "Algebra: Linear Equations",
          objectives: ["Solve systems of equations", "Graph linear relationships", "Model real-world scenarios"],
          tags: ["math", "modeling", "problem-solving", "logic", "analysis", "calculations", "patterns"]
        },
        "algebra-quadratic": {
          name: "Algebra: Quadratic Functions",
          objectives: ["Factor quadratic expressions", "Graph parabolas", "Solve optimization problems"],
          tags: ["math", "modeling", "problem-solving", "design", "optimization", "calculations", "analysis"]
        },
        "geometry-proofs": {
          name: "Geometry: Proofs & Logic",
          objectives: ["Construct logical arguments", "Apply geometric theorems", "Develop spatial reasoning"],
          tags: ["logic", "spatial reasoning", "problem-solving", "analysis", "design", "math", "proof"]
        },
        "statistics-data": {
          name: "Statistics: Data Analysis",
          objectives: ["Interpret datasets", "Create visualizations", "Draw evidence-based conclusions"],
          tags: ["data analysis", "statistics", "pattern recognition", "math", "problem-solving", "research", "modeling"]
        },
        "english-persuasive": {
          name: "English: Persuasive Writing",
          objectives: ["Build compelling arguments", "Use evidence effectively", "Structure persuasive essays"],
          tags: ["persuasion", "writing", "logic", "analysis", "communication", "creativity", "research"]
        },
        "english-research": {
          name: "English: Research & Citations",
          objectives: ["Evaluate sources", "Synthesize information", "Document research properly"],
          tags: ["research", "analysis", "writing", "critical thinking", "communication", "problem-solving"]
        },
        "history-primary": {
          name: "History: Primary Source Analysis",
          objectives: ["Evaluate historical documents", "Identify bias and perspective", "Construct historical arguments"],
          tags: ["analysis", "research", "critical thinking", "writing", "patterns", "problem-solving"]
        },
        "history-economics": {
          name: "History: Economic Systems",
          objectives: ["Compare economic models", "Analyze market forces", "Understand global trade"],
          tags: ["economics", "analysis", "systems", "modeling", "risk assessment", "problem-solving", "patterns"]
        },
        "cs-algorithms": {
          name: "CS: Algorithms & Logic",
          objectives: ["Design step-by-step solutions", "Analyze algorithm efficiency", "Apply computational thinking"],
          tags: ["logic", "problem-solving", "design", "analysis", "patterns", "technology", "math", "modeling"]
        }
      }
    };

    function computeWhyItMatters(careerInput, lessonKey) {
      if (!careerInput.trim()) {
        return {
          career: null,
          lesson: null,
          reframed: "Enter a dream career to see how today's lesson connects!",
          alignment: 0,
          matchedSkills: [],
          discussionStarters: []
        };
      }

      // Fuzzy match career
      const careerKey = Object.keys(gnnGraph.careers).find(key =>
        key.toLowerCase().includes(careerInput.toLowerCase()) ||
        careerInput.toLowerCase().includes(key.split(' ')[0].toLowerCase())
      ) || "Sustainable Design Director";

      const career = gnnGraph.careers[careerKey];
      const lesson = gnnGraph.lessons[lessonKey] || gnnGraph.lessons["chemistry-ratios"];

      // GNN "message passing": find skill/tag overlaps
      const matches = career.keySkills.filter(skill =>
        lesson.tags.some(tag => 
          skill.toLowerCase().includes(tag.toLowerCase()) || 
          tag.toLowerCase().includes(skill.toLowerCase())
        )
      );

      // Calculate alignment with minimum floor
      const rawAlignment = (matches.length / career.keySkills.length) * 100;
      const alignment = Math.max(45, Math.min(95, Math.round(rawAlignment + (matches.length * 10))));

      // Generate personalized reframing
      const primarySkill = matches[0] || career.keySkills[0];
      const reframed = `For someone aiming to be a <strong>${careerKey}</strong>, today's "${lesson.name}" builds <strong>${primarySkill}</strong> skills needed for ${career.whyMatters}.`;

      // Generate dynamic discussion starters
      const discussionStarters = [
        `How might ${lesson.tags[0]} help you succeed as a ${careerKey.toLowerCase()}?`,
        `What part of today's ${lesson.name} lesson feels most connected to your future goals?`,
        `If you were already a ${careerKey.toLowerCase()}, how would you use what we learned today?`
      ];

      return {
        career: careerKey,
        careerIcon: career.icon,
        lesson: lesson.name,
        reframed,
        alignment,
        matchedSkills: matches.slice(0, 4),
        discussionStarters
      };
    }

    // ============================================
    // UI FUNCTIONS
    // ============================================
    
    function setCareer(career) {
      document.getElementById('careerInput').value = career;
      document.querySelectorAll('.career-pill').forEach(p => p.classList.remove('active'));
      event.target.classList.add('active');
      runGNN();
    }

    function runGNN() {
      const careerInput = document.getElementById('careerInput').value;
      const lessonKey = document.getElementById('lessonSelect').value;
      
      if (!careerInput.trim()) {
        alert('Please enter a dream career first!');
        return;
      }

      const result = computeWhyItMatters(careerInput, lessonKey);
      
      // Update UI
      document.getElementById('alignmentScore').textContent = result.alignment + '%';
      document.getElementById('careerNode').textContent = result.career;
      document.getElementById('lessonNode').textContent = result.lesson;
      document.getElementById('reframedText').innerHTML = result.reframed;
      
      // Update matched skills
      const skillsContainer = document.getElementById('matchedSkills');
      skillsContainer.innerHTML = result.matchedSkills.map(skill => 
        `<span class="skill-tag">${skill}</span>`
      ).join('') || '<span class="skill-tag">core skills</span>';
      
      // Update discussion starters
      const discussionList = document.getElementById('discussionList');
      discussionList.innerHTML = result.discussionStarters.map((q, i) => `
        <div class="discussion-item">
          <span class="number">${i + 1}</span>
          <span>${q}</span>
        </div>
      `).join('');
      
      // Show results
      document.getElementById('results').classList.add('visible');
      
      // Smooth scroll to results
      document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Allow Enter key to trigger
    document.getElementById('careerInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') runGNN();
    });

    // Update lesson node when dropdown changes
    document.getElementById('lessonSelect').addEventListener('change', function() {
      if (document.getElementById('results').classList.contains('visible')) {
        runGNN();
      }
    });
  </script>
</body>
</html>
